# RealChat Backend - Render.com Deployment BÉ™lÉ™dÃ§isi

## 1ï¸âƒ£ GitHub-a Push Et

ÆvvÉ™l backend klasÄ±ÄŸÄ± GitHub-a push edÉ™cÉ™yimizi dÃ¼ÅŸÃ¼nÃ¼yÉ™m. SÉ™n `backend` folderini GitHub-a push etmÉ™n lazÄ±mdÄ±r.

```bash
# LayihÉ™ root-da
git add backend/
git commit -m "Add RealChat Backend"
git push origin main
```

---

## 2ï¸âƒ£ Render.com-da Web Service Yarat

### AddÄ±m 1: Render.com-a Daxil Ol
- https://render.com â†’ Dashboard
- **New** â†’ **Web Service**

### AddÄ±m 2: GitHub Repo SeÃ§
- Ã–z `Chat-App` repo-nu seÃ§
- Connect

### AddÄ±m 3: Deploy AyarlarÄ±

| Ayar | DÉ™yÉ™r |
|------|-------|
| **Name** | `realchat-backend` (istÉ™diyiniz ad) |
| **Root Directory** | `backend` |
| **Runtime** | `Node` |
| **Build Command** | `npm install` |
| **Start Command** | `npm start` |
| **Instance Type** | `Free` (yaxud `Starter` premium) |

### AddÄ±m 4: Environment Variables ÆlavÉ™ Et

Render â†’ Environment bÃ¶lmÉ™sinÉ™ bax:

```
PORT=3001
NODE_ENV=production
FRONTEND_ORIGIN=https://your-frontend-url.vercel.app

ACCESS_SECRET=<generate-strong-secret>
REFRESH_SECRET=<generate-strong-secret>

SMTP_HOST=smtp.gmail.com
SMTP_PORT=465
SMTP_SECURE=true
SMTP_USER=your-gmail@gmail.com
SMTP_PASS=<app-password-from-gmail>
SMTP_FROM=noreply@realchat.com
```

**Strong Secret Generasiya Et:**
```bash
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

### AddÄ±m 5: Deploy Et
- **Create Web Service** dÉ™yib, Render Ã¶zÃ¼ deploy edÉ™cÉ™k
- Konsolu izlÉ™ (2-3 dÉ™qiqÉ™ Ã§É™kÉ™ bilÉ™r)

---

## 3ï¸âƒ£ Frontend-i Backend-É™ QoÅŸla

SÉ™nin Next.js frontend-indÉ™, `.env.local` faylÄ±na É™lavÉ™ et:

```env
NEXT_PUBLIC_API_URL=https://your-backend-url.onrender.com
NEXT_PUBLIC_SOCKET_URL=https://your-backend-url.onrender.com
```

Frontend-dÉ™n API Ã§aÄŸÄ±rÄ±ÅŸlarÄ±:

```javascript
// fetch API
const res = await fetch(`${process.env.NEXT_PUBLIC_API_URL}/api/login`, {
  method: 'POST',
  credentials: 'include',  // cookies Ã¼Ã§Ã¼n
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ identifier: 'user', password: 'pass' })
});

// Socket.io
import io from 'socket.io-client';
const socket = io(process.env.NEXT_PUBLIC_SOCKET_URL, {
  reconnectionDelay: 1000,
  reconnection: true,
  reconnectionAttempts: 10,
  transports: ['websocket']
});
```

---

## 4ï¸âƒ£ Test Et

Backend URL (Render dashboardda):
```
https://realchat-backend-xxxxx.onrender.com
```

**Health Check:**
```bash
curl https://realchat-backend-xxxxx.onrender.com/health
# { "ok": true }
```

**Register:**
```bash
curl -X POST https://realchat-backend-xxxxx.onrender.com/api/register/request-otp \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","username":"test","password":"123456"}'
```

---

## 5ï¸âƒ£ SorunlarÄ± DÃ¼zÉ™lt

### Server É™lavÉ™ olmuyor
- Konsolu yoxla: `npm start` Ã§alÄ±ÅŸÄ±rsa?
- PORT 3001-dÉ™ `listen` ediyor?
- `index.js` var?

### Cookies iÅŸlÉ™mir
- `FRONTEND_ORIGIN` dÃ¼zÉ™ldildi?
- CORS active?
- `credentials: 'include'` frontend-dÉ™?

### Socket.io qoÅŸulmuyor
- Access token var?
- WebSocket enabled?
- FRONTEND_ORIGIN frontend URL-sinÉ™ yÃ¶nÉ™ldi?

### Email gÃ¶ndÉ™rilmÉ™di
- SMTP credentials dÃ¼zÉ™ldildi?
- Gmail App Password (2FA tÉ™lÉ™b olunur)?
- SMTP_FROM sahib ola bilÉ™n email?

---

## 6ï¸âƒ£ Free Tier MÉ™hdudiyyÉ™tlÉ™ri

Render Free:
- 15 dÉ™qiqÉ™ inactivity sonra uyuyur (cold start)
- SQLite persistent deyil (redeploy-da silinir)
- Produksiya Ã¼Ã§Ã¼n **Starter** plan lazÄ±mdÄ±r ($7/ay)

**MÉ™slÉ™hÉ™tlÉ™r:**
- Production Ã¼Ã§Ã¼n PostgreSQL istifadÉ™ et (Render Postgres)
- Database backup
- Uptime monitoring

---

## 7ï¸âƒ£ Production Checklist

- [ ] `.env` faylÄ±nÄ± `.gitignore`-ya É™lavÉ™ et (push etmÉ™!)
- [ ] ACCESS_SECRET vÉ™ REFRESH_SECRET gÃ¼clÃ¼ olsun
- [ ] NODE_ENV=production
- [ ] FRONTEND_ORIGIN doÄŸru olsun
- [ ] SMTP credentials iÅŸlÉ™sin
- [ ] SQLite â†’ PostgreSQL migration (real production Ã¼Ã§Ã¼n)
- [ ] HTTPS enabled (Render otomatik)

---

## ğŸ“ Support

ÆgÉ™r qÄ±stÄ±rÄ±rsan:
1. Render logs-u yoxla (Render Dashboard)
2. `npm start` lokal test et
3. `/health` endpoint-i Ã§aÄŸÄ±r
